---
title: Create a Contextual Audience
hide_table_of_contents: true
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import ExternalLink from '@site/static/img/external-link2.svg';

# Create a Contextual Audience 

IQMâ€™s REST API enables you to interact with most of our platform's applications.

The following endpoints will be used to create a Contextual Audience:

## About IQM Contextual Audiences 

The Audience API allows you to create different kinds of Audiences for Campaign targeting. 

## Before You Begin

To create a Contextual Audience, the following are required:

1. An Account On the IQM platform
   *  See [Getting Started](/Getting%20Started/Before-You-Begin) section to create an account and request a Client ID and Client Secret

## Create a Contextual Audience Using the IQM API

### Step 1: Log in

<span class="badge badge--success">POST</span> <span class="path-text">/api/v3/ua/login</span>

<div class="container">
  <div class="child1">

To log in, the <var>Authentication: Basic</var> header is required. The Login API returns an OAuth-compliant response with an Organization Workspace ID (<var>owId</var>), a unique identifier for each Organization. This ID will be used for any further API communications.

For further information see the complete [Login API Documentation](/Guidelines/User-Profile-Guidelines#login).

| Headers  |  |
| ----  | --- |
| `Authentication` <br /><span class="type-text">string</span> <span class="required-text">required</span> | Authentication bearer token <br />See [Authentication Guide](/Quickstart%20Guides/Authentication-Quickstart-Guide)<br /> |
| `X-IAA-HOST` <br /><span class="type-text">string</span> <span class="required-text">required</span> | Workspace URL |

| Request Schema  |  |
| ----  | --- |
| `grantType` <br /><span class="type-text">string</span> <span class="required-text">required</span> | [OAuth Grant Types<ExternalLink />](https://oauth.net/2/grant-types/) |
| `email` <br /><span class="type-text">string</span> <span class="required-text">required</span> | User account email |
| `password` <br /><span class="type-text">string</span> <span class="required-text">required</span> | User account password |

</div><div class="child2">

<Tabs>
<TabItem value="JSON" label="JSON" default>

```json title="Request Schema"
{
  "grantType": "password",
  "email": "pratik.t+ihp@iqm.com",
  "password": "123456"
}
```

```json title="Response 200"
{
  "success": true,
  "data":
  {
    "access_token": "106adb25-37b0-4cab-8381-d682fe7cc3c8",
    "refresh_token": "eac4c1f6-781e-4b04-baff-9c2e415d1f64",
    "scope": "read write",
    "token_type": "bearer",
    "expires_in": 35999,
    "owId": 200001
  }
}
```

<details className="objectPropertiesDetails" style={{ maxWidth: "100%", padding: "1rem" }}>
<summary style={{fontSize: "16px"}}>>More Responses</summary>

```json title="Response 400"
{
   "success": false,
   "data":
   {
      "status": "On Hold",
      "reason": "The particular account is kept on hold due to missed payment dates for last 3 months.",
      "supportEmail": "support@iqm.com"
   },
   "errorObjects":
   [
      {
         "error": "User is not allowed to access provided customer",
         "reason": "User is not associated with any active organization."
      }
   ]
}
```

```json title="Response 403"
{
   "success": false,
   "errorObjects":
   [
      {
         "error": "User doesn't exist or user is not allowed to provided workspace."
      }
   ]
}
```
</details>

</TabItem>
<TabItem value="TypeScript" label="TypeScript">

See [TypeScript Prerequisites](/Getting%20Started/Typescript-Prerequisites.mdx) page for usage. 

```ts
import {
  getInstance
} from "prerequisites"

const axios = getInstance();

interface Responses {
  200: {
    content: {
      "application/json": {
        success: boolean;
        data: {
          access_token: string;
          refresh_token: string;
          scope: string;
          token_type: string;
          expires_in: number;
          owId: number;
        };
      };
    };
  };
  400: {
    content: {
      "application/json": {
        success: boolean;
        data: {
          status: string;
          reason: string;
          supportEmail: string;
        };
        errorObjects: {
          error: string;
          reason: string;
        }[];
      };
    };
  };
  403: {
    content: {
      "application/json": {
        success: boolean;
        errorObjects: {
          error: string;
        }[];
      };
    };
  };
};

function Login(): Promise < Responses > {
  const options = {
    method: 'POST',
    url: 'https://app.iqm.com/api/v3/ua/login',
    requestBody: {
      content: {
        "application/json": {
          email: `string`,
          password: `string`,
        }
      }
    }
  };

  return axios.request(options).then(({ data }: { data: Responses }) => data);
}
```

</TabItem></Tabs>

</div></div>

### Step 2: Create a Contextual Audience

<span class="badge badge--success">POST</span> <span class="path-text">/api/v3/audience/contextual/add</span>

<div class="container">
  <div class="child1">

You can create a Contextual Audience with just a few parameters. For this example, come up with your desired <var>audienceName</var>, select a few <var>keywords</var>, pass <var>2</var> as the <var>dataCollectionMethodId</var>, pass <var>20</var> as the <var>dataCollectionDays</var>, and pass a number between 1-10 for the <var>frequency</var>. 

In the provided example, this will build an Audience of any user that visits a site relevant to the keywords "politics", "voters", or "california" at least 5 times. This Audience will collect data on a rolling basis for the previous 20 days, refreshing the data set every 24 hours. 


| Request Schema | |
| --- | --- |
| `audienceName` <br /><span class="type-text">string</span> | Audience name 
| `keywords` <br /><span class="type-text">string</span> | Keywords to generate contextual Audience 
| `frequency` <br /><span class="type-text">integer</span> | The number of times a user visits the publisher(s) relevant to one or more keywords or URLs added to the contextual Audience. Integer between 1-10
| `timezoneId` <br /><span class="type-text">integer</span> | Timezone ID 
| `dataCollectionMethodId` <br /><span class="type-text">integer</span> | **static** (<var>1</var>) collection period in a fixed set of dates <br />**dynamic** (<var>2</var>) data collection period over a rolling timeframe, with data refreshes every 24 hours
| `dataCollectionDays` <br /><span class="type-text">integer</span> | Number of days for data collection timeframe when data collection method is **dynamic** (maximum value: <var>30</var>)

<details className="objectPropertiesDetails" style={{ maxWidth: "100%", padding: "1rem"}}>
    <summary style={{fontSize: "16px"}}>Response Properties</summary>
    <table className="objectProperties">
    <tr>
    <td>`id` <br /><span class="type-text">integer</span></td>
    <td>Audience ID</td>
    </tr>
    <tr>
    <td>`message` <br /><span class="type-text">string</span></td>
    <td>Success message</td>
    </tr>
    </table>
    </details>

</div>
<div class="child2">

<Tabs>
<TabItem value="JSON" label="JSON" default>

```json title="Request Sample"
{
  "audienceName": "California Politics",
  "frequency": 5,
  "keywords": "politics, voters, california",
  "dataCollectionMethodId": 2,
  "dataCollectionDays": 20
}
```

```json title="Response 200"
{
  "success": true,
  "data": {
    "id": 1078146,
    "message": "Contextual Audience created successfully"
  }
}
```

</TabItem>
<TabItem value="TypeScript" label="TypeScript">

See [TypeScript Prerequisites](/Getting%20Started/Typescript-Prerequisites.mdx) for usage. 

```ts
import {
  getInstance
} from "prerequisites"

const axios = getInstance();

interface Responses {
  200: {
    content: {
      "application/json": {
        success: boolean;
        data: {
          id: number;
          message: string;
        };
      };
    };
  };
}

function createContextualAudiences(): Promise<Responses> {
  const options = {
    method: 'POST',
    url: 'https://app.iqm.com/api/v3/audience/contextual/add',
    requestBody: {
      content: {
        "application/json": {
          audienceName: `string`,
          keywords?: `string`,
          urls?: `string`,
          frequency?: `number`,
          startDate?: `number`,
          endDate?: `number`,
          timezoneId?: 'number',
          dataCollectionMethodId: 'number',
          dataCollectionDays?: 'number',

        }
      }
    }
  };

  return axios.request(options).then(({ data }: { data: Responses }) => data);
}
```

</TabItem></Tabs>

</div></div>

### Step 3: Check Audience Status